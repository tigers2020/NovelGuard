# 성능 벤치마크 기준선

## 개요

이 문서는 NovelGuard의 리팩토링 전 성능 기준선을 문서화합니다. 리팩토링 과정에서 성능 회귀를 감지하기 위한 기준점으로 사용됩니다.

## 측정 환경

- **측정 시각**: 2026-01-09
- **플랫폼**: Windows (win32)
- **Python 버전**: 3.14.0
- **데이터셋**: medium fixture (100개 파일)

## 측정 항목 및 결과

### 1. 스캔 처리량 (Scan Throughput)

**목적**: 파일 스캔 속도 측정

**측정 방법**:
- `ScanFilesUseCase.execute()` 실행
- 100개 파일 스캔
- 3회 반복 후 평균 계산

**결과**:
- **처리량**: 152,484.1 files/sec
- **평균 소요 시간**: 0.001 sec
- **허용 범위**: ±5%

**해석**: 
- 매우 빠른 처리 속도 (파일이 작고 캐시된 상태)
- 실제 대용량 파일에서는 더 느릴 수 있음

### 2. 중복 탐지 처리량 (Duplicate Detection Throughput)

**목적**: 중복 탐지 알고리즘 성능 측정

**측정 방법**:
- 100개 파일 스캔 후 `FindDuplicatesUseCase.execute()` 실행
- 3회 반복 후 평균 계산

**결과**:
- **처리량**: 0.0 groups/sec (중복 그룹이 없음)
- **비교 속도**: 5,324,736.74 comparisons/sec
- **평균 소요 시간**: 0.001 sec
- **허용 범위**: ±5%

**해석**:
- 매우 빠른 비교 속도
- 중복 그룹이 없어 groups/sec는 의미 없음
- 실제 중복이 있는 데이터셋에서 재측정 필요

### 3. 메모리 사용량 (Memory Usage)

**목적**: 전체 워크플로우 실행 시 메모리 사용량 측정

**측정 방법**:
- 전체 스캔 + 중복 탐지 워크플로우 실행
- psutil을 사용한 RSS (Resident Set Size) 측정

**결과**:
- **초기 RSS**: 25.5 MB
- **최종 RSS**: 25.5 MB
- **델타 RSS**: 0.01 MB

**해석**:
- 메모리 사용량이 매우 적음 (100개 파일 기준)
- 대용량 데이터셋에서는 증가할 것으로 예상

### 4. CPU 시간 (CPU Time)

**목적**: CPU 사용 시간 측정

**측정 방법**:
- `time.process_time()` 사용
- 전체 워크플로우 실행

**결과**:
- **CPU 시간**: 0.0 sec

**해석**:
- 매우 짧은 처리 시간
- 100개 파일은 너무 작아서 측정이 어려움
- 더 큰 데이터셋에서 재측정 필요

## 허용 범위 및 게이트 정책

### Soft Gate (경고)
- 기준선 대비 ±5% 초과 시 경고
- 작업은 계속 진행 가능
- 로컬 환경에서 주로 사용

### Hard Gate (실패)
- 기준선 대비 ±10% 초과 시 실패
- CI 환경에서 PR block
- 성능 회귀 방지

## 재측정 권장 사항

현재 측정은 **소규모 데이터셋 (100개 파일)** 기준입니다. 더 정확한 기준선을 위해 다음 데이터셋에서 재측정을 권장합니다:

1. **대규모 데이터셋**: 1000개 이상 파일
2. **실제 중복 포함**: 중복 그룹이 있는 데이터셋
3. **다양한 파일 크기**: 작은 파일 + 큰 파일 혼합

## 측정 재현 방법

```bash
# 기준선 측정
python tests/performance/benchmark_baseline.py

# 결과 확인
cat tests/performance/benchmark_baseline.json
```

## 주의사항

1. **CI 환경 편차**: CI 환경은 리소스가 가변적이므로 허용 범위를 더 넓게 설정할 수 있음 (±10% → ±15%)
2. **측정 안정성**: 3회 반복 평균을 사용하여 안정성 확보
3. **캐시 효과**: 반복 측정 시 파일 시스템 캐시 효과로 빨라질 수 있음

## 업데이트 이력

- **2026-01-09**: 초기 기준선 측정 (Phase 0.5.3)
